# Figma Plugin Specification — «Указка»

## 0. Технологии и языки разработки

Плагин создаётся на основе стандартного стека Figma Plugins:

### Основной код плагина

* **TypeScript** (рекомендуется) или JavaScript
* Выполняется в среде **Figma Plugin Sandbox** (аналог Web Worker)
* Нет доступа к DOM
* Доступ к API Figma через `figma.*`

### UI

* **UI отсутствует полностью**. Плагин не открывает окно и не требует взаимодействия.

### Конфигурация

* Обязательный файл **manifest.json**, содержащий:

  * название плагина
  * id
  * ссылку на `main` (code.ts)
  * разрешения
  * ресурсы

### Ресурсы

* `pointer.png` — изображение указки
* `click.mp3` — звук двойного клика

Все ресурсы уже включены в проект. Пользователь ничего не загружает.

---

## 1. Общее описание

«Указка» — это плагин для демонстраций и презентаций. Он автоматически добавляет указку и проигрывает звук вместе с анимацией при **двойном клике пользователя по любому месту макета**.

Плагин:

1. Автоматически добавляет PNG‑указку на Canvas.
2. Загружает встроенный звук клика.
3. Использует одну встроенную анимацию «клика».
4. Реагирует **на двойной клик в любом месте проекта**, а не только по самой указке.
5. Срабатывает мгновенно и не требует UI.

---

## 2. Основные функции

### 2.1 Автоматическое добавление указки

* PNG‑указка добавляется сразу при запуске.
* Создаётся Frame или Component с фоновой картинкой.
* Указка размещается в центре видимой области.
* Размер можно менять вручную через Figma.

### 2.2 Звук двойного клика

* Встроенный звук `click.mp3` подключён к компоненту.
* При двойном клике звук проигрывается.
* Звук воспроизводится даже если двойной клик не по самой указке.

### 2.3 Единственная анимация — «Click Animation»

Анимация сочетает:

* краткое увеличение указки (scale 0.9 → 1.1 → 1.0)
* Smart Animate
* синхронное проигрывание звука

После завершения указка возвращается в исходное состояние.

### 2.4 Глобальный двойной клик

Плагин регистрирует обработчик двойного клика.

При **любом** двойном клике:

* воспроизводится звук;
* включается анимация указки.

Это даёт эффект «живой указки» во всём макете.

---

## 3. UI плагина

UI **полностью отсутствует**.
При запуске плагин сразу работает.

---

## 4. Техническая реализация

### 4.1 Файлы проекта

```
/manifest.json
/code.ts
/assets/pointer.png
/assets/click.mp3
```

### 4.2 Взаимодействие

* Коммуникации `postMessage` отсутствуют (нет UI).
* Весь код находится в `code.ts`.

### 4.3 Добавление указки

1. Загрузка `pointer.png` через `figma.createImageAsync`.
2. Создание Frame.
3. Установка фонового изображения через Fills → IMAGE.
4. Позиционирование в видимой области: `figma.viewport.center`.

### 4.4 Аудио

Figma не предоставляет полноценное аудио‑API, поэтому используется Prototype‑audio.

Звук запускается двумя способами:

#### 1. Prototype‑interaction

* Добавляется действие Play Audio к компоненту.

#### 2. Программный вызов звука

* В Canvas создаётся скрытый Audio‑Node.
* При двойном клике он активируется.

### 4.5 Анимация

Анимация создаётся как **две variant‑версии**:

* Normal — scale 1.0
* Click — scale 1.1

Плагин при двойном клике:

1. Переключает state на Click.
2. Ждёт 120–150 мс.
3. Возвращает state на Normal.

Анимация Smart Animate обеспечивает плавность.

---

## 5. Требования к UX

* Плагин включается и работает автоматически.
* Реакция на двойной клик должна быть моментальной.
* Переходы анимации — не более 150 мс.
* Указка должна масштабироваться без потери качества.

---

## 6. Минимальный рабочий MVP

1. Автоматическая вставка PNG‑указки.
2. Звук двойного клика встроенный и работает.
3. Анимация клика реализована через Smart Animate.
4. Двойной клик в любом месте вызывает звук и анимацию.

---

## 7. Будущие улучшения

* Кастомизация размера указки кнопками.
* Несколько тем указок.
* Несколько встроенных звуков.

---

## 8. Лицензирование

* Все ресурсы — часть плагина.
* Пользователь не загружает свои файлы.
